<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoMac | Home</title>
    <link rel="stylesheet" href="output.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@900&display=swap" rel="stylesheet">
</head>
<body>

<!-- GO TO TOP BUTTON -->
<div class="topbutton fixed bottom-8 right-8 bg-white p-2 rounded-full text-blue-600 border border-blue-600 text-xl animate-wiggle animate-infinite hidden items-center transition-all duration-500 ease-in-out cursor-pointer shadow-md hover:bg-blue-100">
    <ion-icon name="arrow-up-outline"></ion-icon>
</div>

<!-- MOBILE MENU -->
<div class="lg:hidden fixed w-0 h-full bg-slate-500/90 text-white flex flex-col justify-center items-center text-[40px] tracking-[1px] overflow-hidden origin-left duration-500 backdrop-filter backdrop-blur-sm" id="hammenu">
    <div class="flex flex-col items-center w-full border-b-2 border-white lg:border-none">
        <ion-icon name="close-outline" id="closeButton" class="absolute text-white text-2xl top-7 right-6 cursor-pointer"></ion-icon>
            <ul>
                <li class="mb-2 hover:translate-y-[-5px] transition-all"><a href="home.html">Home</a></li>
                <li class="mb-2 hover:translate-y-[-5px] transition-all"><a href="explore.html">Explore</a></li>
                <li class="mb-2 hover:translate-y-[-5px] transition-all"><a href="wallet.html">Wallet</a></li>
                <li class="mb-2 hover:translate-y-[-5px] transition-all whitespace-nowrap"><a href="aboutus.html">About us</a></li>
            </ul>
    </div>
    <ul class="mt-5 lg:hidden">
        <li class="mb-2 hover:translate-y-[-5px] transition-all"><a href="#">Sign in</a></li>
        <li class="mb-2 hover:translate-y-[-5px] transition-all"><a href="#">Register</a></li>
    </ul>
</div>

<!-- HEADER -->
<header class="header bg-white sticky top-0">
    <nav class="mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8" aria-label="Global">
        <div class="flex md:flex-1">
            <a href="#" class="-m-1.5 p-1.5"><span class="title | text-blue-600 text-xl font-bold">CryptoMac</span></a>
        </div>
        <div class="hidden lg:flex lg:gap-x-12 lg:flex-1 justify-center">
            <a href="home.html" class="text-sm font-semibold leading-6 text-gray-900 hover:text-gray-500 transition-all">Home</a>
            <a href="explore.html" class="text-sm font-semibold leading-6 text-gray-900 hover:text-gray-500 transition-all">Explore</a>
            <a href="wallet.html" class="text-sm font-semibold leading-6 text-gray-900 hover:text-gray-500 transition-all">Wallet</a>
            <a href="aboutus.html" class="text-sm font-semibold leading-6 text-gray-900 hover:text-gray-500 transition-all whitespace-nowrap">About us</a>
        </div>
        <div id="header-search" class="hidden md:flex gap-x-1.5 md:flex-1 justify-end relative md:mr-24 lg:mr-0 z-40">
            <label for="Search1" class="sr-only">Search</label>
            <input type="search" id="Search1" placeholder="Search" class="rounded-md border focus:outline-none focus:border-blue-600 py-2 px-3 pe-12 sm:text-sm" />
            <span class="absolute inset-y-0 end-0 grid w-10 place-content-center">
                <button type="button" class="text-gray-600 hover:text-gray-900">
                <span class="sr-only">Search</span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 w-4" > <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" /> </svg>
                </button>
            </span>
        </div>
        <div class="lg:hidden cursor-pointer flex items-center">
            <ion-icon name="search-outline" id="searchButton" class="search-icon md:hidden mr-10 text-lg"></ion-icon>
            <ion-icon name="menu-outline" id="openButton" class="text-2xl"></ion-icon>
        </div>
    </nav>
</header>

<!-- MOBILE SEARCH BAR -->
<div id="mobile-search" class="hidden fixed top-0 left-0 w-screen h-screen bg-gray-900/50 backdrop-filter backdrop-blur-md z-90 transition-all md:hidden">
    <span class="x cursor-pointer text-6xl text-white hover:text-blue-600 absolute right-8 top-5 transition-all">&times;</span>
    <div class="w-full h-full flex justify-center items-center">
        <div class="w-5/6 rounded-md border border-white flex bg-white">
            <input type="text" placeholder="Search" name="search"
                class="w-full px-3 py-2 rounded-md focus:outline-none">
            <button class="mobile-search-icon w-1.5/6 px-3 py-2 -ml-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="relative h-4 w-4 mx-2" > <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" /> </svg></button>
        </div>
    </div>
</div>

<!-- PURCHASE ALERT -->
<div id="alert" class="hidden items-center fixed w-4/6 top-24 left-1/2 transform -translate-x-1/2 p-4 mb-4 border-t-4 border-green-300 bg-green-50 text-green-400 transition-all" role="alert">
    <svg class="flex-shrink-0 w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
      <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
    </svg>
    <div class="ms-3 text-sm font-medium">Purchase successful!</div>
    <button type="button" id="alertButton" class="ms-auto -mx-1.5 -my-1.5 bg-green-50 text-green-500 rounded-lg focus:ring-2 focus:ring-green-400 p-1.5 hover:bg-green-200 inline-flex items-center justify-center h-8 w-8 dark:text-green-400"  data-dismiss-target="#alert-border-3" aria-label="Close">
      <span class="sr-only">Dismiss</span>
      <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
      </svg>
    </button>
</div>

<!-- ERROR PURCHASE ALERT -->
<div id="alerterror" class="hidden items-center fixed w-4/6 top-24 left-1/2 transform -translate-x-1/2 p-4 mb-4 border-t-4 border-yellow-300 bg-yellow-50 text-yellow-400 transition-all" role="alert">
    <svg class="flex-shrink-0 w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
      <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
    </svg>
    <div class="ms-3 text-sm font-medium">You have already purchased this coin!</div>
    <button type="button" id="alertErrorButton" class="ms-auto -mx-1.5 -my-1.5 bg-yellow-50 text-yellow-500 rounded-lg focus:ring-2 focus:ring-yellow-400 p-1.5 hover:bg-yellow-200 inline-flex items-center justify-center h-8 w-8 dark:text-yellow-400"  data-dismiss-target="#alert-border-3" aria-label="Close">
      <span class="sr-only">Dismiss</span>
      <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
      </svg>
    </button>
</div>

<!-- COIN MARKET -->
<section>
    <div class="prices-div container mx-auto pt-20 pb-6">
        <div class="prices flex flex-col items-center md:items-start md:px-16 lg:px-24 mb-12">
            <h2 class="title text-3xl font-extrabold text-gray-900">Cryptocurrency prices</h2>
        </div>
    </div>
    <div class="showallcoins container hidden px-5 mx-auto mb-6 cursor-pointer md:hidden">
        <a class="text inline-flex items-center text-gray-900 hover:text-blue-900 transition-all"><ion-icon name="chevron-back-outline"></ion-icon>Show all coins</a>
    </div>
    <div class="bigcontdiv container flex flex-col mx-auto pb-10">
        <div class="sm:px-14 hidden md:flex sm:flex-col">
            <table class="w-full text-sm text-left">
                <thead class="title text-xs text-gray-700 border-b">
                    <tr>
                        <th scope="col" class="px-6 py-3">Currency</th>
                        <th scope="col" class="px-6 py-3">Price</th>
                        <th scope="col" class="px-6 py-3">24h Change</th>
                        <th scope="col" class="px-6 py-3">Market Cap</th>
                    </tr>
                </thead>
                <tbody class="coinsdiv text text-gray-500">

                </tbody>
            </table>
        </div>
    </div>
</section>

<!-- FOOTER -->
<footer>
    <div class="container flex flex-col items-center pt-10 mx-auto">
        <h2 class="title text-blue-600 text-3xl font-extrabold mb-5 w-full text-center pb-5 border-b border-gray-300">CryptoMac</h2>
        <div class="flex flex-col sm:flex-row wrap md:flex-row p-10 sm:grid sm:grid-cols-2 sm:gap-x-40 sm:gap-y-10 lg:flex lg:flex-row lg:gap-x-32 gap-y-8 border-b border-gray-300">
            <div class="flex flex-col">
                <h4 class="title text-gray-900 text-xl font-bold mb-2">Get In Touch</h4>
                <p class="text inline-flex items-center mb-2"><ion-icon name="location-outline" class="text-blue-600 text-2xl mx-2"></ion-icon>123 Street, New York, USA</p>
                <p class="text inline-flex items-center mb-2"><ion-icon name="call-outline" class="text-blue-600 text-2xl mx-2"></ion-icon>+012 345 67890</p>
                <p class="text inline-flex items-center mb-2"><ion-icon name="mail-outline" class="text-blue-600 text-2xl mx-2"></ion-icon>info@cryptomac.com</p>
            </div>
            <div class="flex flex-col whitespace-nowrap">
                <h4 class="title text-gray-900 text-xl font-bold mb-2">Our Company</h4>
                <a href="aboutus.html" class="text inline-flex items-center mb-2 hover:text-blue-900 transition-all"><ion-icon name="chevron-forward-outline" class="text-blue-600 text-xl mx-1"></ion-icon>About Us</a>
                <a href="#" class="text inline-flex items-center mb-2 hover:text-blue-900 transition-all"><ion-icon name="chevron-forward-outline" class="text-blue-600 text-xl mx-1"></ion-icon>Contact Us</a>
                    <a href="#" class="text inline-flex items-center mb-2 hover:text-blue-900 transition-all"><ion-icon name="chevron-forward-outline" class="text-blue-600 text-xl mx-1"></ion-icon>Terms & Conditions</a>
            </div>
            <div class="flex flex-col whitespace-nowrap">
                <h4 class="title text-gray-900 text-xl font-bold mb-2">Our Services</h4>
                <a href="#" class="text inline-flex items-center mb-2 hover:text-blue-900 transition-all"><ion-icon name="chevron-forward-outline" class="text-blue-600 text-xl mx-1"></ion-icon>Currency Wallet</a>
                <a href="#" class="text inline-flex items-center mb-2 hover:text-blue-900 transition-all"><ion-icon name="chevron-forward-outline" class="text-blue-600 text-xl mx-1"></ion-icon>Currency Transaction</a>
                <a href="#" class="text inline-flex items-center mb-2 hover:text-blue-900 transition-all"><ion-icon name="chevron-forward-outline" class="text-blue-600 text-xl mx-1"></ion-icon>Bitcoin Investment</a>
                <a href="#" class="text inline-flex items-center mb-2 hover:text-blue-900 transition-all"><ion-icon name="chevron-forward-outline" class="text-blue-600 text-xl mx-1"></ion-icon>Currency Exchange</a>
            </div>
            <div class="flex flex-col">
                <h4 class="title text-gray-900 text-xl font-bold mb-2">Follow Us</h4>
                <div class="flex flex-row">
                    <a href="#"><ion-icon name="logo-twitter" class="text-blue-600 text-xl mx-1 border border-blue-600 rounded-full p-2.5 hover:bg-blue-600 hover:text-white transition-all"></ion-icon></a>
                    <a href="#"><ion-icon name="logo-facebook" class="text-blue-600 text-xl mx-1 border border-blue-600 rounded-full p-2.5 hover:bg-blue-600 hover:text-white transition-all"></ion-icon></a>
                    <a href="#"><ion-icon name="logo-youtube" class="text-blue-600 text-xl mx-1 border border-blue-600 rounded-full p-2.5 hover:bg-blue-600 hover:text-white transition-all"></ion-icon></a>
                    <a href="#"><ion-icon name="logo-linkedin" class="text-blue-600 text-xl mx-1 border border-blue-600 rounded-full p-2.5 hover:bg-blue-600 hover:text-white transition-all"></ion-icon></a>
                </div>
            </div>
        </div>
        <div class="py-2">
            <h4 class="text text-gray-600">&copy; <a href="#" class="text text-blue-600">CryptoMac</a>, All Rights Reserved.</h4>
        </div>
    </div>
</footer>

<script src="/node_modules/axios/dist/axios.min.js"></script>
<script src="/assets/js/dynamicListener.min.js"></script>
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script type="module">
    import {headerShadow, toggleButtons} from '../components/functions.js'
    import {Cryptos, mobileCryptos} from '../components/coins.js'
    headerShadow()
    openButton.addEventListener('click', toggleButtons)
    closeButton.addEventListener('click', toggleButtons)

    document.querySelector('#searchButton').addEventListener('click', (e) => {
        e.preventDefault()
        document.querySelector('#mobile-search').classList.toggle('hidden')
    })

    document.querySelector('.x').addEventListener('click', () => {
        document.getElementById('mobile-search').classList.toggle('hidden')
    })

    let originalData = [];

    axios.get('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc')
    .then(res => {
        if(res.status === 200){
            const coins = res.data
            originalData = coins

            document.querySelector('.coinsdiv').innerHTML = Cryptos(coins)
            document.querySelector('.bigcontdiv').insertAdjacentHTML('beforeend', mobileCryptos(coins))
        }
    })

    const headerSearch = document.querySelector('#header-search input')
    const mobileSearch = document.querySelector('#mobile-search input[name="search"]')
    const searchIcon = document.querySelector('.mobile-search-icon')
    const showCoins = document.querySelector('.showallcoins')

    if(headerSearch !== null && mobileSearch !== null){
        headerSearch.addEventListener('input', e => {
            e.preventDefault()

            const searchTerm = e.target.value.toLowerCase()
            const filteredCoins = originalData.filter(coin => coin.name.toLowerCase().includes(searchTerm) || coin.symbol.toLowerCase().includes(searchTerm))

            document.querySelector('.coinsdiv').innerHTML = Cryptos(filteredCoins)
            })

        mobileSearch.addEventListener('keyup', e => {
            e.preventDefault()

            const searchTerm = e.target.value.toLowerCase()
            const filteredCoins = originalData.filter(coin => coin.name.toLowerCase().includes(searchTerm) || coin.symbol.toLowerCase().includes(searchTerm))

            searchIcon.addEventListener('click', e => {

                const clickedIcon = filteredCoins
                document.querySelector('.bigcontdiv').innerHTML = mobileCryptos(clickedIcon)
                document.querySelector('#mobile-search').classList.toggle('hidden')
                showCoins.classList.toggle('hidden')

                showCoins.addEventListener('click', () => {
                    document.querySelector('.bigcontdiv').innerHTML = mobileCryptos(originalData)
                    showCoins.classList.add('hidden')
                })

            })
        })
    }

    addDynamicEventListener(document.body, 'click', '.buybutton', e => {
        document.querySelector('#alert').classList.remove('hidden')
        document.querySelector('#alert').classList.add('flex')

        document.querySelector('#alertButton').addEventListener('click', () => {
            document.querySelector('#alert').classList.remove('flex')
            document.querySelector('#alert').classList.add('hidden')
        })

        const mycoins = JSON.parse(localStorage.getItem('mycoins'))
        let coinId = e.target.getAttribute('id')
        let purchasedCoin = originalData.filter(coin => coin.id === coinId)

        if(mycoins === null){
            localStorage.setItem('mycoins', JSON.stringify([...purchasedCoin]))
        } else {
            if (!mycoins.some(coin => coin.id === coinId)) {
                localStorage.setItem('mycoins', JSON.stringify([...mycoins, ...purchasedCoin]))

                } else {
                    document.querySelector('#alert').classList.remove('flex')
                    document.querySelector('#alert').classList.add('hidden')
                    document.querySelector('#alerterror').classList.remove('hidden')
                    document.querySelector('#alerterror').classList.add('flex')

                    document.querySelector('#alertErrorButton').addEventListener('click', () => {
                    document.querySelector('#alerterror').classList.remove('flex')
                    document.querySelector('#alerterror').classList.add('hidden')
                })
            }
        }
    })

    const topButton = document.querySelector('.topbutton')
        window.addEventListener('scroll', () => {
            if(window.scrollY > 300){
                topButton.classList.remove('hidden')
                topButton.classList.add('inline-flex')
            } else {
                topButton.classList.add('hidden')
                topButton.classList.remove('inline-flex')
            }
        })

        topButton.addEventListener('click', () =>{
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            })
        })
</script>   
</body>
</html>